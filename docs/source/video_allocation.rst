.. _video-allocation:

Привязка группы камер к экземпляру ``video-worker``
======================================================

.. note::
   Поддерживается только в ОС Ubuntu.

Часто в распределенной архитектуре (например, сеть гостиниц, магазинов, несколько проходных) обработку видеоизображения с группы камер требуется выполнять локально, не обращаясь к центральному серверу и не перераспределяя видеопотоки между удаленными экземплярами ``video-worker``. В этом случае группу камер привязывают к локально установленному экземпляру.

Для обработки видео с группы камер в определенном экземпляре компонента ``video-worker`` выполните следующие действия:

#. В веб-интерфейсе перейдите на вкладку :guilabel:`Группы камер`.
#. Откройте настройки группы камер.
#. В поле :guilabel:`Метки` создайте или выберите из уже созданных одну или несколько меток для привязки группы камер к экземпляру ``video-worker``. Сохраните изменения.
#. Откройте файл конфигурации экземпляра ``video-worker`` и укажите в нем заданные метки в формате ``имя_метки=true`` (``terminal_1`` в примере ниже). 

   .. code::

      sudo vi /etc/video-worker.ini
      
      wrk-labels=terminal_1=true

#. Перезапустите ``video-worker``.

   .. code::

      sudo systemctl restart video-worker.service

.. note::
   Если камере присвоена метка, то видеопоток с нее может обрабатываться как экземпляром ``video-worker`` с аналогичной меткой, так и экземпляром ``video-worker`` без меток. 

.. warning::
   Если камера с меткой обрабатывается экземпляром ``video-worker`` без меток и появляется свободный экземпляр с меткой, камера автоматически на него не переключится. Чтобы переключить камеру, перезапустите экземпляр ``video-worker`` с меткой.



