.. _worker-installer:

Дополнительное развертывание ``video-worker`` на удаленных серверах
=======================================================================

В случае если на удаленном сервере нужно установить только компонент ``video-worker``,  можно использовать мини-инсталлятор.

Для развертывания ``video-worker`` из мини-инсталлятора выполните следующие действия:

#. Загрузите файл инсталлятора ``<video-worker-xxx>.run``.
#. Поместите файл ``.run`` в любой каталог на сервере установки (например, ``/home/username``).
#. Из данного каталога сделайте файл ``.run`` исполняемым.

   .. code::

       chmod +x <video-worker-xxx>.run

#. Запустите файл ``.run``. Компонент ``video-worker`` будет автоматически установлен.

   .. code::

       sudo ./<video-worker-xxx>.run

   .. note::
      При установке вам потребуется ответить на следующие вопросы:

      * Указать IP-адрес сервера с компонентом ``findface-videomanager-api``.
      * Указать, какой IP-адрес использовать для обращения к компоненту ``ntls``.
      * Задать метки для привязки определенных камер к данному экземпляру ``video-worker`` (см. :ref:`video-allocation`). 
       

   .. tip::
      IP-адреса и метки могут быть заданы при запуске файла ``.run`` в параметрах командной строки. Используйте следующие опции: ``-v``: задание IP-адреса сервера ``findface-videomanager-api``, ``-n``: задание IP-адреса сервера ``ntls``, ``-l``: задание меток для привязки определенных камер к данному экземпляру ``video-worker``.


       .. code::

          sudo ./<video-worker-xxx>.run -v 127.0.0.1 -n 172.163.42.34 -l "label1=true;label2=true"
        
#. Откройте для редактирования файл конфигурации ``/etc/video-worker.ini``.

   .. code::   

      sudo vi /etc/video-worker.ini

#. В параметре ``ntls-addr`` укажите IP-адрес локального сервера лицензирования NTLS.

   .. code::

      ntls-addr=127.0.0.1:3133

#. В параметре ``mgr-static`` укажите IP-адрес сервера с установленным компонентом ``videomanager-api``, у которого компонент ``video-worker`` будет запрашивать настройки и список видеопотоков.

   .. code::

      mgr-static=127.0.0.1:18811

#. В параметре ``capacity`` укажите максимальное количество видеопотоков, обрабатываемых компонентом ``video-worker``. 

   .. code::

      capacity=10



